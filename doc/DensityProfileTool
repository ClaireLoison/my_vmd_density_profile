<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>utilities/DensityProfileTool</title><revhistory><revision><revnumber>101</revnumber><date>12.06.2014 18:03:47</date><authorinitials>toni</authorinitials></revision><revision><revnumber>100</revnumber><date>11.06.2014 14:01:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>99</revnumber><date>21.05.2014 16:43:37</date><authorinitials>toni</authorinitials></revision><revision><revnumber>98</revnumber><date>30.01.2014 14:57:09</date><authorinitials>toni</authorinitials></revision><revision><revnumber>97</revnumber><date>03.12.2013 10:32:10</date><authorinitials>toni</authorinitials></revision><revision><revnumber>96</revnumber><date>26.11.2013 10:25:17</date><authorinitials>toni</authorinitials></revision><revision><revnumber>95</revnumber><date>16.10.2013 13:46:11</date><authorinitials>toni</authorinitials></revision><revision><revnumber>94</revnumber><date>05.09.2013 14:42:00</date><authorinitials>toni</authorinitials></revision><revision><revnumber>93</revnumber><date>28.08.2013 14:35:16</date><authorinitials>toni</authorinitials></revision><revision><revnumber>92</revnumber><date>26.08.2013 10:18:17</date><authorinitials>toni</authorinitials></revision><revision><revnumber>91</revnumber><date>26.08.2013 10:17:43</date><authorinitials>toni</authorinitials></revision><revision><revnumber>90</revnumber><date>23.08.2013 09:31:35</date><authorinitials>toni</authorinitials></revision><revision><revnumber>89</revnumber><date>23.08.2013 09:17:42</date><authorinitials>toni</authorinitials></revision><revision><revnumber>88</revnumber><date>23.08.2013 09:17:16</date><authorinitials>toni</authorinitials></revision><revision><revnumber>87</revnumber><date>23.08.2013 09:10:14</date><authorinitials>toni</authorinitials></revision><revision><revnumber>86</revnumber><date>23.08.2013 09:09:42</date><authorinitials>toni</authorinitials></revision><revision><revnumber>85</revnumber><date>09.08.2013 15:39:42</date><authorinitials>toni</authorinitials></revision><revision><revnumber>84</revnumber><date>02.08.2013 17:21:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>83</revnumber><date>02.08.2013 16:06:28</date><authorinitials>toni</authorinitials></revision><revision><revnumber>82</revnumber><date>01.08.2013 11:06:03</date><authorinitials>toni</authorinitials></revision><revision><revnumber>81</revnumber><date>13.05.2013 14:10:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>80</revnumber><date>05.05.2013 21:09:18</date><authorinitials>toni</authorinitials></revision><revision><revnumber>79</revnumber><date>22.03.2013 10:19:10</date><authorinitials>toni</authorinitials></revision><revision><revnumber>78</revnumber><date>22.03.2013 10:16:07</date><authorinitials>toni</authorinitials></revision><revision><revnumber>77</revnumber><date>22.03.2013 10:14:26</date><authorinitials>toni</authorinitials></revision><revision><revnumber>76</revnumber><date>21.02.2013 11:14:37</date><authorinitials>toni</authorinitials></revision><revision><revnumber>75</revnumber><date>20.02.2013 09:12:34</date><authorinitials>toni</authorinitials></revision><revision><revnumber>74</revnumber><date>20.02.2013 09:11:41</date><authorinitials>toni</authorinitials></revision><revision><revnumber>73</revnumber><date>19.02.2013 20:03:28</date><authorinitials>toni</authorinitials></revision><revision><revnumber>72</revnumber><date>19.02.2013 19:47:49</date><authorinitials>toni</authorinitials></revision><revision><revnumber>71</revnumber><date>19.02.2013 19:43:50</date><authorinitials>toni</authorinitials></revision><revision><revnumber>70</revnumber><date>19.02.2013 19:43:27</date><authorinitials>toni</authorinitials></revision><revision><revnumber>69</revnumber><date>18.01.2013 12:26:14</date><authorinitials>toni</authorinitials></revision><revision><revnumber>68</revnumber><date>18.01.2013 12:23:34</date><authorinitials>toni</authorinitials></revision><revision><revnumber>67</revnumber><date>18.12.2012 18:40:38</date><authorinitials>toni</authorinitials></revision><revision><revnumber>66</revnumber><date>18.12.2012 18:38:51</date><authorinitials>toni</authorinitials></revision><revision><revnumber>65</revnumber><date>17.12.2012 17:56:25</date><authorinitials>toni</authorinitials></revision><revision><revnumber>64</revnumber><date>14.12.2012 14:55:09</date><authorinitials>toni</authorinitials></revision><revision><revnumber>63</revnumber><date>14.12.2012 14:52:46</date><authorinitials>toni</authorinitials></revision><revision><revnumber>62</revnumber><date>14.12.2012 14:51:44</date><authorinitials>toni</authorinitials></revision><revision><revnumber>61</revnumber><date>14.12.2012 14:46:14</date><authorinitials>toni</authorinitials></revision><revision><revnumber>60</revnumber><date>14.12.2012 14:45:48</date><authorinitials>toni</authorinitials></revision><revision><revnumber>59</revnumber><date>14.12.2012 14:37:31</date><authorinitials>toni</authorinitials></revision><revision><revnumber>58</revnumber><date>08.09.2011 12:08:26</date><authorinitials>toni</authorinitials></revision><revision><revnumber>57</revnumber><date>08.09.2011 12:08:05</date><authorinitials>toni</authorinitials></revision><revision><revnumber>56</revnumber><date>08.09.2011 12:07:34</date><authorinitials>toni</authorinitials></revision><revision><revnumber>55</revnumber><date>08.09.2011 12:06:56</date><authorinitials>toni</authorinitials></revision><revision><revnumber>54</revnumber><date>25.08.2011 13:27:07</date><authorinitials>toni</authorinitials></revision><revision><revnumber>53</revnumber><date>26.07.2011 14:09:17</date><authorinitials>toni</authorinitials></revision><revision><revnumber>52</revnumber><date>26.07.2011 11:50:33</date><authorinitials>toni</authorinitials></revision><revision><revnumber>51</revnumber><date>18.05.2011 17:46:31</date><authorinitials>toni</authorinitials></revision><revision><revnumber>50</revnumber><date>18.05.2011 17:46:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>49</revnumber><date>18.05.2011 17:45:38</date><authorinitials>toni</authorinitials></revision><revision><revnumber>48</revnumber><date>21.02.2011 22:00:27</date><authorinitials>toni</authorinitials></revision><revision><revnumber>47</revnumber><date>20.02.2011 23:17:56</date><authorinitials>toni</authorinitials></revision><revision><revnumber>46</revnumber><date>20.02.2011 23:16:39</date><authorinitials>toni</authorinitials></revision><revision><revnumber>45</revnumber><date>20.02.2011 23:13:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>44</revnumber><date>09.02.2011 16:06:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>43</revnumber><date>09.02.2011 16:04:37</date><authorinitials>toni</authorinitials></revision><revision><revnumber>42</revnumber><date>09.02.2011 16:00:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>41</revnumber><date>09.02.2011 15:39:28</date><authorinitials>toni</authorinitials></revision><revision><revnumber>40</revnumber><date>09.02.2011 15:38:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>39</revnumber><date>09.02.2011 15:12:51</date><authorinitials>toni</authorinitials></revision><revision><revnumber>38</revnumber><date>09.02.2011 15:11:24</date><authorinitials>toni</authorinitials></revision><revision><revnumber>37</revnumber><date>09.02.2011 15:11:06</date><authorinitials>toni</authorinitials></revision><revision><revnumber>36</revnumber><date>09.02.2011 15:10:25</date><authorinitials>toni</authorinitials></revision><revision><revnumber>35</revnumber><date>09.02.2011 02:15:59</date><authorinitials>toni</authorinitials></revision><revision><revnumber>34</revnumber><date>09.02.2011 02:03:29</date><authorinitials>toni</authorinitials></revision><revision><revnumber>33</revnumber><date>09.02.2011 02:02:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>32</revnumber><date>09.02.2011 02:01:44</date><authorinitials>toni</authorinitials></revision><revision><revnumber>31</revnumber><date>09.02.2011 01:59:40</date><authorinitials>toni</authorinitials></revision><revision><revnumber>30</revnumber><date>09.02.2011 01:59:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>29</revnumber><date>09.02.2011 01:58:14</date><authorinitials>toni</authorinitials></revision><revision><revnumber>28</revnumber><date>09.02.2011 01:54:01</date><authorinitials>toni</authorinitials><revremark>new tool</revremark></revision><revision><revnumber>27</revnumber><date>18.12.2010 01:25:24</date><authorinitials>toni</authorinitials></revision><revision><revnumber>26</revnumber><date>18.12.2010 01:23:32</date><authorinitials>toni</authorinitials></revision><revision><revnumber>25</revnumber><date>18.12.2010 01:02:35</date><authorinitials>toni</authorinitials></revision><revision><revnumber>24</revnumber><date>18.12.2010 01:01:25</date><authorinitials>toni</authorinitials></revision><revision><revnumber>23</revnumber><date>18.12.2010 00:59:55</date><authorinitials>toni</authorinitials></revision><revision><revnumber>22</revnumber><date>18.12.2010 00:54:17</date><authorinitials>toni</authorinitials></revision><revision><revnumber>21</revnumber><date>18.12.2010 00:52:21</date><authorinitials>toni</authorinitials></revision><revision><revnumber>20</revnumber><date>17.12.2010 19:07:34</date><authorinitials>toni</authorinitials></revision><revision><revnumber>19</revnumber><date>17.12.2010 19:02:39</date><authorinitials>toni</authorinitials></revision><revision><revnumber>18</revnumber><date>17.12.2010 19:01:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>17</revnumber><date>17.12.2010 18:59:33</date><authorinitials>toni</authorinitials></revision><revision><revnumber>16</revnumber><date>17.12.2010 18:53:19</date><authorinitials>toni</authorinitials></revision><revision><revnumber>15</revnumber><date>17.12.2010 18:48:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>14</revnumber><date>17.12.2010 18:47:38</date><authorinitials>toni</authorinitials></revision><revision><revnumber>13</revnumber><date>17.12.2010 18:45:35</date><authorinitials>toni</authorinitials></revision><revision><revnumber>12</revnumber><date>01.11.2010 09:13:46</date><authorinitials>toni</authorinitials></revision><revision><revnumber>11</revnumber><date>31.10.2010 17:42:04</date><authorinitials>toni</authorinitials></revision><revision><revnumber>10</revnumber><date>31.10.2010 17:41:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>9</revnumber><date>31.10.2010 16:59:29</date><authorinitials>toni</authorinitials></revision><revision><revnumber>8</revnumber><date>31.10.2010 16:56:50</date><authorinitials>toni</authorinitials></revision><revision><revnumber>7</revnumber><date>31.10.2010 16:56:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>6</revnumber><date>31.10.2010 16:51:24</date><authorinitials>toni</authorinitials></revision><revision><revnumber>5</revnumber><date>31.10.2010 16:48:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>4</revnumber><date>31.10.2010 16:41:51</date><authorinitials>toni</authorinitials></revision><revision><revnumber>3</revnumber><date>31.10.2010 16:38:50</date><authorinitials>toni</authorinitials></revision><revision><revnumber>2</revnumber><date>31.10.2010 16:36:37</date><authorinitials>toni</authorinitials></revision><revision><revnumber>1</revnumber><date>31.10.2010 16:36:12</date><authorinitials>toni</authorinitials></revision></revhistory></articleinfo><section><title>VMD Density Profile Tool (1.1)</title><para>Toni Giorgino </para><itemizedlist><listitem override="none"><para>2012-2013 (ISIB-CNR) Consiglio Nazionale delle Ricerche </para><para> 2011 (GRIB-IMIM-UPF) Computational Biophysics Laboratory </para></listitem></itemizedlist><para>The <emphasis>Density Profile Tool</emphasis> is a VMD analysis plugin that computes 1-D projections of various atomic densities. The computation can be performed in a single frame, a trajectory, or averaged over multiple frames. </para><itemizedlist><listitem><para>Atomic (number) density, i.e. average number of atoms </para></listitem><listitem><para>Mass density </para></listitem><listitem><para>Charge density </para></listitem><listitem><para>Electron density, i.e.  number density of electrons. </para></listitem></itemizedlist><para>This tool is fully described in the reference given below. This page serves only as a quick-reference. </para><section><title>Installation and licensing</title><para>By downloading this software you agree to comply with the terms of the 3-clause BSD license (see LICENSE-BSD.txt).  <emphasis role="strong">The code comes without any warranty of fitness for any use. It is UNSUPPORTED. After you download it, you are on your own. </emphasis>  </para><para><ulink url="https://github.com/tonigi/vmd_density_profile/releases/latest">Download the plugin</ulink> and follow the instructions therein. </para><para>You may or may not be able to get support by posting to the <ulink url="https://sourceforge.net/p/membplugin/discussion/external_tools/">External tools</ulink> forum hosted at the <ulink url="http://membplugin.sourceforge.net">MEMBPLUGIN</ulink> site. </para></section><section><title>Citation</title><para>Please cite the following publication: </para><itemizedlist><listitem override="none"><para>Toni Giorgino, Computing 1-D atomic densities in macromolecular simulations: the Density Profile Tool for VMD, <emphasis>Computer Physics Communications</emphasis> Volume 185, Issue 1, January 2014, Pages 317–322, <ulink url="http://dx.doi.org/10.1016/j.cpc.2013.08.022">doi:10.1016/j.cpc.2013.08.022</ulink> –<!--RAW HTML: &ndash;--> <ulink url="http://arxiv.org/abs/1308.5873">arXiv:1308.5873</ulink> </para></listitem></itemizedlist></section><section><title>Usage (GUI)</title><para>The plugin is accessible from VMD in <emphasis>Extensions &gt; Analysis &gt; Density Profile Tool</emphasis>. By default, the profile is computed for the current frame in the <emphasis>top</emphasis> molecule. For mass and charge computation, a topology file must be loaded. </para><para>When dealing with a trajectory, the behaviour depends on the <emphasis>average</emphasis> check box: if selected, density profiles for all of the frames will be plotted; otherwise, the average plus or minus the standard deviation will be displayed.  </para><para>If periodic cell information is available in the molecule (e.g. as set in <emphasis>pbctools</emphasis>), the density will be properly normalized with respect to the volume. Otherwise, it will be simply projected along a linear axis. <emphasis role="strong">IMPORTANT: you will still need to wrap the trajectory yourself.</emphasis> </para><para><emphasis>Electron density</emphasis> calculations require the atomic number <emphasis>Z</emphasis> (i.e., the element) to be known for each atom. This information may be obtained from either the <emphasis>mass</emphasis>, <emphasis>name</emphasis>, <emphasis>type</emphasis>, or <emphasis>element</emphasis> atom properties (see VMD manual). Selecting <emphasis role="strong"><emphasis>mass</emphasis> is highly recommended</emphasis> because <emphasis>element</emphasis> is usually unset, and guessing from <emphasis>type</emphasis> or <emphasis>name</emphasis> requires error-prone heuristics. Atomic number guessing is based on the <ulink url="http://www.ks.uiuc.edu/Research/vmd/plugins/topotools/#TOC-guessatom-property-from-">topotools guessatom</ulink> function and algorithm. Note that the heuristics will likely be inappropriate in the case of united atom/coarse grain forcefields. </para></section><section><title>Usage (command line)</title><para>A command line interface is available to perform the same calculations as the GUI. See help with  </para><screen><![CDATA[vmd > package require density_profile
vmd > density_profile
]]><![CDATA[
Usage: density_profile <args>
Args (with defaults):
   -rho electrons
   -selection name P11
   -axis z
   -resolution 1
   -Zsource type
   -partial_charges 1
   -frame_from 0
   -frame_to 130
   -frame_step 1
   -average 1]]></screen><para>Where <code>-rho</code>  is one of  <emphasis>number, mass, charge</emphasis> or <emphasis>electrons</emphasis>. In the latter case, <code>-Zsource</code> must be one of <emphasis>mass, element, name, type</emphasis>. The function returns two lists: </para><itemizedlist><listitem><para>The <emphasis role="strong">lower coordinate</emphasis> of each bin, i.e. a list of bin breaks. </para></listitem><listitem><para>A list of <emphasis role="strong">densities for each bin</emphasis>. Each element of the list is </para><itemizedlist><listitem><para>a single value, if only one frame is selected, or <emphasis>average</emphasis> is 1 </para></listitem><listitem><para>a list of density values, one for each of the frames computed </para></listitem></itemizedlist></listitem></itemizedlist><para><emphasis role="strong">IMPORTANT: when used on the command line, bin BREAKS are returned. When plotting, dots are placed in bin CENTERS.</emphasis> </para></section><section><title>Units</title><para>Assuming that periodic box information is available, results are given in the following units: </para><itemizedlist><listitem><para>Atomic density: atoms/Å<superscript>3</superscript> </para></listitem><listitem><para>Mass density: amu/Å<superscript>3</superscript>=Da/Å<superscript>3</superscript> </para></listitem><listitem><para>Charge density: e/Å<superscript>3</superscript> </para></listitem><listitem><para>Electron density: electrons/Å<superscript>3</superscript> </para></listitem></itemizedlist><para><emphasis role="strong">Unit conversions:</emphasis> </para><itemizedlist><listitem><para>in moles per liter, multiply by 1661 Å³ mol/l (or the value appropriate at your temperature) </para></listitem><listitem><para>1 amu/Å<superscript>3</superscript> = 1.66 g/cm<superscript>3</superscript> = 1660 kg/m<superscript>3</superscript> </para></listitem></itemizedlist></section><section><title>Example</title><para>See attached screenshots. Left: solvent density profile around a POPC membrane. Note how the water density in bulk goes to the macroscopic value of 18/30 amu/Å³. Right: electron density profile of a POPC membrane (solvent included). </para><para><ulink url="http://www1.multiscalelab.org/utilities/DensityProfileTool/utilities/DensityProfileTool?action=AttachFile&amp;do=get&amp;target=POPC-waters-mass-density-profile.png"><inlinemediaobject><imageobject><imagedata fileref="http://www1.multiscalelab.org//utilities/DensityProfileTool?action=AttachFile&amp;do=get&amp;target=POPC-waters-mass-density-profile.png" width="200"/></imageobject><textobject><phrase>attachment:POPC-waters-mass-density-profile.png</phrase></textobject></inlinemediaobject></ulink>  <ulink url="http://www1.multiscalelab.org/utilities/DensityProfileTool/utilities/DensityProfileTool?action=AttachFile&amp;do=get&amp;target=POPC-e-density-profile.png"><inlinemediaobject><imageobject><imagedata fileref="http://www1.multiscalelab.org//utilities/DensityProfileTool?action=AttachFile&amp;do=get&amp;target=POPC-e-density-profile.png" width="200"/></imageobject><textobject><phrase>attachment:POPC-e-density-profile.png</phrase></textobject></inlinemediaobject></ulink>  </para></section><section><title>Limitations</title><itemizedlist><listitem><para>atoms are assumed as point-like </para></listitem><listitem><para>only orthorhombic cells are supported </para></listitem><listitem><para>to compute volumetric densities, cell information must be present for <emphasis>all</emphasis> frames </para></listitem></itemizedlist></section><section><title>Screenshot</title><para><inlinemediaobject><imageobject><imagedata fileref="http://www1.multiscalelab.org//utilities/DensityProfileTool?action=AttachFile&amp;do=get&amp;target=Screenshot-Density+Profile+Tool.png"/></imageobject><textobject><phrase>Screenshot-Density Profile Tool.png</phrase></textobject></inlinemediaobject> </para></section><section><title>Acknowledgments</title><para>Partial support from the Agència de Gestió d'Ajuts Universitaris i de Recerca - Generalitat de Catalunya is gratefully acknowledged. </para></section></section></article>